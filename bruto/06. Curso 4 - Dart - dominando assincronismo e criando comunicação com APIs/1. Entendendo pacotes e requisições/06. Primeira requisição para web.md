## Primeira requisição para web

Instalamos o pacote `http`, que nos ajudará a **realizar a comunicação com o Gist**. Porém, pode surgir a seguinte dúvida: *de onde vem esse pacote?*

### Usando pacotes no Dart

### Acessando o repositório pub.dev

Com o **navegador** aberto, acessaremos uma **página extremamente importante** para pessoas desenvolvedoras que trabalham com Dart e Flutter aberta: o [pub.dev](https://pub.dev/).

O **pub.dev** o **repositório oficial de pacotes do Dart e do Flutter**, construído **pelo Google**, que é responsável pelo Flutter e pelo Dart. É neste **site que buscamos pacotes** (no nosso caso, o `http`).

### Buscando o pacote http
O primeiro pacote listado ao buscarmos por "http" é o `http`.

> Antes do pacote `http`, temos o pacote recomendado dart:core, mas, normalmente, não focamos diretamente nele. Instalaremos de fato o segundo pacote listado.

Nesta página, encontramos **todas as informações sobre o pacote**. Entender isso é crucial, pois, conforme surgem necessidades de terceirizar ações, recorremos a esse recurso frequentemente.

Na vida de uma pessoa programadora, é **inviável programar tudo do zero**. Muitas vezes, **programar usando pacotes de outras pessoas é mais rápido e seguro**, pois já foi amplamente testado.

Como em uma pesquisa no Google, é necessário saber **identificar o que é confiável ou não**.

### Importando o pacote `http`

Feito isso, vamos **voltar ao código** para usar, de fato, o pacote `http`. Com o arquivo main.dart aberto, começaremos pela importação do pacote, pois ele ainda não está presente.

No topo do código, faremos um `import` seguido de `http`. Dentro do pacote `package:http/`, há vários arquivos. Nesse caso, queremos importar apenas o arquivo chamado `http.dart`.

```dart
// main.dart:

import 'package:http/http.dart';

void main() {
  print("Olá, mundo!");
}
```

**Observação**: Nesse momento, *o pacote aparecerá em amarelo, pois foi importado*, mas ainda não está em uso. Isso é importante pois, ao importar um pacote, o arquivo final fica mais pesado e um pouco mais difícil de carregar. Assim, caso o pacote não esteja sendo usado, há um desperdício de recursos.

### Criando a função `requestData()`

Para usar o pacote, após a função `main()`, vamos declarar a função `requestData()`, **responsável pela requisição de dados**. Ela poderia receber qualquer nome, mas chamaremos dessa forma.

No escopo desta função, **começaremos estabelecendo a URL** que será utilizada para requisitar os dados, ou seja, para **qual URL o pacote irá apontar**. Para isso, criaremos uma `String` chamada `url`, que, por enquanto, receberá uma string vazia (`""`).

```dart
import 'package:http/http.dart';

void main() {
  print("Olá, mundo!");
}

requestData() {
  String url = "";
}
```

Para **obter a URL**, podemos **voltar ao navegador**, onde temos o arquivo `accounts.json` aberto no **GitHub**. Basta **copiar o endereço da barra de navegação** e compor a `String url`.

```dart
// código omitido

requestData() {
  String url = "https://gist.githubusercontent.com/ricarthlima/a0eb198cb7a70696c4031e7e577de0cd/raw/356ce2c39dfd58d3d2e948d1ad87ea828544f1db/accounts.json";
}
```

### Utilizando o método `get()`

Agora que temos a `url`, podemos usar uma função do pacote `http` chamada `get()`, que **significa pegar, capturar, ou requisitar.** A função `get()` não estaria disponível se não tivéssemos importado a biblioteca `http` anteriormente. Podemos até mesmo fazer um teste:

A **função solicita um objeto do tipo `Uri`**, que é a `url`. Portanto, a URL passada como String não funciona nesse caso. Essa é uma convenção sobre como nos comunicamos usando programação na web: para isso, utilizamos **objetos `Uri`**, que basicamente **dividem a `String` em partes**.

> Por exemplo: o **host é quem está no início na URL**, enquanto o **endpoint está no final**. O próprio objeto faz esse trabalho de divisão. No entanto, para não precisarmos fazer a conversão manualmente, existe uma forma automática de trabalhar com isso.

**No método `get()`**, em vez de passar `url`, vamos chamar um objeto `Uri`, que possui um **construtor chamado parse (`Uri.parse()`)**. O `parse()` está preparado para receber uma URL em formato de `String` e **convertê-la para o formato `Uri`**. Com isso, passamos `url` para `parse()`.

```dart
// código omitido

requestData() {
  String url = "https://gist.githubusercontent.com/ricarthlima/a0eb198cb7a70696c4031e7e577de0cd/raw/356ce2c39dfd58d3d2e948d1ad87ea828544f1db/accounts.json";
  get(Uri.parse(url));
}
```

Para finalizar, precisamos **chamar a função `requestData()`** no escopo de `main()`:

Nesta etapa, também podemos **comentar a linha do `print()`** de "Olá, mundo!".

```dart
import 'package:http/http.dart';

void main() {
  // print("Olá, mundo!");
  requestData();
}

// código omitido
```

Agora, o **método `get()` é responsável por pegar o que está no arquivo `accounts.json`** nos servidores do GitHub e **trazer para a nossa aplicação**. Vamos imprimir para verificar se funciona de fato?

### Testando o código

Ainda na mesma linha, **envolveremos o método `get()` com um `print()`**.

```dart
import 'package:http/http.dart';

void main() {
  // print("Olá, mundo!");
  requestData();
}

requestData() {
  String url = "https://gist.githubusercontent.com/ricarthlima/a0eb198cb7a70696c4031e7e577de0cd/raw/356ce2c39dfd58d3d2e948d1ad87ea828544f1db/accounts.json";
  print(get(Uri.parse(url)));
}
```

Feito isso, vamos **abrir o terminal** com o atalho **"Ctrl + J"** e executar o seguinte comando:

```sh
dart run bin/main.dart
```

Como **retorno**, recebemos a seguinte resposta:

```
Instance of Future<Response> (ou "Instância de Future<Response>")
```

### Conclusão

Não é exatamente isso que esperávamos. Um ponto positivo é que **não houve erro**, mas também não recebemos as informações das contas das pessoas usuárias do nosso banco. Portanto, precisamos fazer um tratamento, e o segredo está na palavra "Future" (futuro).

