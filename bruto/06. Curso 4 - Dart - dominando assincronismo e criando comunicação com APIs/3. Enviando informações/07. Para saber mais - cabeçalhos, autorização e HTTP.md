## Para saber mais: cabeçalhos, autorização e HTTP

Vamos nos aprofundar em **verbos, cabeçalhos e autorização**. Esses elementos vão desempenhar **papéis críticos na comunicação** entre cliente e servidor, garantindo que as requisições sejam bem formadas, seguras e que as respostas sejam adequadamente processadas.

### Verbos HTTP

Os verbos HTTP, também conhecidos como **métodos**, **especificam a ação desejada a ser realizada em um recurso no servidor**. Cada verbo tem um propósito específico e, ao usar o pacote `http` no Dart, é importante escolher o verbo adequado para cada operação.

APIs RESTful seguem o padrão a seguir, mas é sempre **essencial a leitura da documentação da API** para entender como o servidor está preparado para receber cada requisição.

Ah! Sempre que for falado de **"recurso" no contexto de comunicação com APIs**, em geral, você pode entender como um **"objeto" a ser manipulado**. Por exemplo, no nosso projeto do curso, o "recurso" seria uma conta, mas poderia ser uma pessoa usuária, uma transferência, um empréstimo, etc.

- **GET**: usado para **solicitar a recuperação de dados de um servidor**. As requisições GET devem ser idempotentes, o que significa que **elas não devem causar efeitos colaterais, independentemente de quantas vezes forem chamadas**.
  - Exemplo: `http.get(Uri.parse('<https://api.exemplo.com/recursos/1>'))` recupera os dados do recurso com ID 1.

- **POST**: usado para **enviar dados ao servidor para criar um novo recurso**. As requisições POST em geral não são idempotentes, o que significa que **várias chamadas podem resultar na criação de múltiplos recursos idênticos**.
  - Exemplo: `http.post(Uri.parse('<https://api.exemplo.com/recursos>'), body: jsonEncode({'nome': 'Novo Recurso'}))` cria um novo recurso com os dados fornecidos.

- **PUT**: usado para **atualizar completamente um recurso existente ou criar um novo recurso se ele não existir**. Diferente do POST, em geral, o **PUT é idempotente**.
  - Exemplo: `http.put(Uri.parse('<https://api.exemplo.com/recursos/1>'), body: jsonEncode({'nome': 'Recurso Atualizado'}))` atualiza o recurso com ID 1.

- **DELETE**: utilizado para **remover um recurso do servidor**. As requisições DELETE também **são idempotentes**.
  - Exemplo: `http.delete(Uri.parse('<https://api.exemplo.com/recursos/1>'))` remove o recurso com ID 1.

- **PATCH**: aplicado para **atualizar parcialmente um recurso** existente. Ele permite que você modifique **apenas partes específicas do recurso**.
  - Exemplo: `http.patch(Uri.parse('<https://api.exemplo.com/recursos/1>'), body: jsonEncode({'nome': 'Recurso Parcialmente Atualizado'}))` modifica o nome do recurso com ID 1.

Entender e usar corretamente esses verbos é essencial para a construção de APIs RESTful bem estruturadas e para a comunicação eficaz com essas APIs a partir de um aplicativo Flutter.

### Cabeçalhos HTTP

Os cabeçalhos HTTP são partes fundamentais de uma requisição ou resposta HTTP, **carregando informações adicionais que ajudam a definir como a mensagem deve ser tratada**.

No Dart, ao usar o pacote `http`, você pode configurar os cabeçalhos ao construir uma requisição, passando um mapa de cabeçalhos na solicitação.

Alguns dos **cabeçalhos mais comuns** em comunicações HTTP são:

- **Content-Type**: informa ao servidor o **tipo de conteúdo** que está sendo enviado ou ao cliente o tipo de conteúdo que está sendo recebido. Por exemplo, **ao enviar dados em formato JSON**, você deve definir o cabeçalho **`Content-Type` como `application/json`**.

- **Authorization**: utilizado para **passar informações de autenticação, como tokens JWT**, permitindo que o servidor identifique e autorize o cliente para acessar recursos protegidos.

- **Cache-control**: controla o **comportamento de cache das respostas HTTP**, definindo se e por quanto tempo a resposta pode ser armazenada em cache pelo cliente ou proxy.

- **Accept**: informa ao servidor **quais tipos de mídia o cliente está disposto a aceitar na resposta**, como application/json ou text/html.

- **User-agent**: **identifica o software** (navegador, aplicativo) **que está fazendo a requisição**, ajudando o servidor a ajustar a resposta com base nas capacidades do cliente.

Por muitas vezes esses cabeçalhos são essenciais para garantir que as requisições sejam tratadas corretamente pelo servidor e que o cliente receba a resposta esperada.

### Autorização

A autorização em requisições HTTP é importante para garantir que **apenas pessoas usuárias ou sistemas autenticados possam acessar** ou manipular recursos sensíveis.

**O cabeçalho `Authorization` é muito utilizado para passar tokens de acesso**, que o servidor usa para verificar as permissões.

- **Bearer Tokens**: um **tipo comum de token utilizado em APIs RESTful**. O token é geralmente obtido após o processo de autenticação e **deve ser incluído em todas as requisições subsequentes**, por exemplo, `Authorization: Bearer <seu-token>`.

- **Basic auth**: um **método mais simples e menos seguro**, onde as credenciais são codificadas em Base64 e enviadas junto com a requisição, por exemplo, `Authorization: Basic <código-base64>`. Esse método é geralmente usado em APIs onde a **segurança não é uma grande preocupação** ou em ambientes internos.

- **OAuth**: **protocolo de autorização que permite que aplicativos acessem recursos em nome de um usuário sem expor suas credenciais diretamente**. O OAuth usa tokens de acesso que devem ser enviados no cabeçalho `Authorization`.
  
A segurança dessas informações é de extrema importância, e é comum utilizar HTTPS para criptografar essas requisições, evitando que as credenciais ou tokens sejam interceptados por atacantes.

### Para saber (ainda) mais

Para uma compreensão ainda mais profunda sobre o funcionamento dos cabeçalhos, autorização e verbos HTTP, recomendo a leitura da [documentação do pacote HTTP](https://pub.dev/packages/http) no Dart, que oferece uma visão detalhada de como implementar e utilizar essas funcionalidades em suas aplicações.

Além disso, para uma imersão completa no protocolo HTTP e suas particularidades, sugiro o curso [HTTP: entendendo a web por baixo dos panos](https://www.alura.com.br/curso-online-http-entendendo-web-por-baixo-dos-panos), disponível na Alura.